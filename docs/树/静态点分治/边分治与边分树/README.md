# 边分治与边分树

## 边分治

### 边分治的原理

1. 边划分的两个连通区，较大连通区的规模能取得最小值 （最平衡划分），这样的边就是重心边。
2. 树上任意点的度数 `<= 3` 的情况下：
    1. 重心边的其中一个端点，一定是树的重心点。
    2. 如果重心点的最大子树有多个，那么重心边就有多条，所有重心边一定相邻且共享重心点。
    3. 重心点通向最大子树的边，就是重心边。
    4. 重心边划分的较大连通区的节点数是 `O(n * 2 / 3)` 规模。
    5. 每次以重心边来分解当前连通区，那么和点分治类似，分治层数是 `O(log n)` 。
3. 普通树可能分治层数较多，比如菊花图，所以需要树的三度化重构。

### 三度化重构的注意点

1. 补充的虚点和虚边，权值如何设置需要注意，不同题目可能有不同设置。
2. 重构的树，边的序号从 `2` 开始使用，每组正边和反边，连边顺序保证相邻。
3. 如果某条边的序号为 `e` ，那么 `(e ^ 1)` 就是该边的反向边。
4. 如果某条边的序号为 `e` ，那么 `(e >> 1)` 就是该边的组号。
5. 利用 `vis[边的组号]` 判断当前的边，是否是之前的重心边。

### 寻找重心边的过程

1. 普通的树先完成三度化重构。
2. 遇到之前的重心边直接跳过。
3. 找到当前连通区的重心点 `x` ，通向最大子树的边，就是重心边。

### 边分治的地位

1. 点分治和边分治解决问题的类型几乎相同，都是路径/点对的统计类问题。
2. 点分治每次讨论跨越当前重心点的答案，边分治每次讨论跨越当前重心边的答案。
3. 解决问题的类型相似，边分治还要三度化重构，所以边分治是点分治的补充内容，较为冷门。

### 边分治的优势

1. 点分治需要处理多棵子树的信息。
2. 边分治只需处理两个连通区的信息，分析和实现往往更容易。
3. 点分治处理多棵子树时，有时需要按秩依次处理，防止复杂度爆炸。
4. 边分治不用考虑多棵子树的处理顺序问题，因为就两个连通区。
5. 边分治和边分树，都是二叉结构带来的优势，其实优势极为强劲，目前虽然冷门，但很有开发潜力。

## 边分树

1. 边分树一般不需要显式的建立，每条重心边的两侧信息，由每个点集各自记录。
2. 初始时，每个节点只记录和自己有关的重心边信息，就是只有一条路径的信息树。
3. 每棵信息树的结构完全相同，两棵信息树可以合并成一棵树，代表合并后的点集拥有的重心边信息。
4. 信息树上的一个节点代表一条重心边，两侧信息的一个组合就是跨越重心边的一个点对/简单路径。
5. 两棵信息树，在同一个节点，可以枚举左右侧信息的组合，来枚举两个点集组合出的点对/简单路径。
6. 重心边的信息不会保留所有可能性，会有取舍策略，比如取最大、取最小、求和等等。
7. 这种信息树就是边分树，因为结构是二叉的，所以可以像线段树那样，进行可持久化、合并操作。
8. 这种二叉结构带来的优势，点分树是不具备的。
