# [494. ç›®æ ‡å’Œ](https://leetcode.cn/problems/target-sum/)

# [å‰‘æŒ‡ Offer II 102. åŠ å‡çš„ç›®æ ‡å€¼](https://leetcode.cn/problems/YaVDxD/)


> - ***Question***
>   - ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ `nums` å’Œä¸€ä¸ªæ•´æ•° `target`
>   - å‘æ•°ç»„ä¸­çš„æ¯ä¸ªæ•´æ•°å‰æ·»åŠ Â `+` æˆ– `-` ï¼Œç„¶åä¸²è”èµ·æ‰€æœ‰æ•´æ•°ï¼Œå¯ä»¥æ„é€ ä¸€ä¸ªè¡¨è¾¾å¼ï¼š
>     - ä¾‹å¦‚ `nums = [2, 1]` ï¼Œå¯ä»¥åœ¨ `2` ä¹‹å‰æ·»åŠ  `+` ï¼Œåœ¨ `1` ä¹‹å‰æ·»åŠ  `-` ï¼Œç„¶åä¸²è”èµ·æ¥å¾—åˆ°è¡¨è¾¾å¼ `+2-1` 
>   - è¿”å›å¯ä»¥é€šè¿‡ä¸Šè¿°æ–¹æ³•æ„é€ çš„ä¸”è¿ç®—ç»“æœç­‰äº `target` çš„ä¸åŒåŠ å‡è¡¨è¾¾å¼çš„æ•°ç›®
>   - ***tips:***
>     - `1 <= nums.length <= 20` 
>     - `0 <= nums[i] <= 1000` 
>     - `0 <= sum(nums[i]) <= 1000` 
>     - `-1000 <= target <= 1000`

---

## *Java*

> - ***æš´åŠ›é€’å½’***
>   - é€šè¿‡å‡è®¾èƒ½å¤Ÿè®¡ç®—å¾—å‡º `rest` æ¥è¿›è¡Œå°è¯•ï¼Œå…·ä½“ç»†èŠ‚çœ‹ `violenceRecursion` 
> - ***è®°å¿†åŒ–æœç´¢***
>   - åœ¨æš´åŠ›é€’å½’ä¸­ä½¿ç”¨ä¸€å¼ äºŒç»´ `HashMap` æ¥å­˜å‚¨è®¡ç®—ç»“æœï¼Œå­˜å‚¨ç»†èŠ‚çœ‹å‚æ•°å®šä¹‰
> - ***äºŒç»´åŠ¨æ€è§„åˆ’***
>   - å…ˆè¿›è¡Œ4ä¸ªä¼˜åŒ–ï¼š
>     - `nums` ä¸­çš„æ•°å­—çš„æ­£è´Ÿæ•°ä¸å¦ä¸å½±å“è®¡ç®—ç»“æœï¼Œå› ä¸ºä½ ä¼šéšæœºåŠ ä¸Š `+` å’Œ `-`
>     - å¦‚æœ `nums` ä¸­çš„ç´¯åŠ å’Œå…¨ä¸º `sum` ï¼Œå¦‚æœ `sum < target` ï¼Œå³å…¨å– `+` è¿˜å°äºç›®æ ‡å€¼ï¼Œåˆ™è¿”å› `0`
>     - `nums` ä¸­çš„æ•°å­—åŠ å‡ä¸ä¼šæ”¹å˜å¥‡å¶æ€§ï¼Œå¦‚æœ `sum` å’Œ `target` çš„å¥‡å¶æ€§ä¸åŒï¼Œåˆ™è¿”å› `0`
>     - è®¾ `num` ä¸­åœ¨å‰é¢æ·»åŠ  `+` çš„æ•°å­—é›†åˆä¸º `P` ï¼Œæ·»åŠ  `-` çš„æ•°å­—é›†åˆ `N` ï¼Œåˆ™æœ‰ `sum(P) - sum(N) = target` ï¼Œæ”¹é€ æœ‰ `sum(P) - sum(N) + sum(P) + sum(N) = target + sum(P) + sum(N)` ï¼Œå³ `sum(P) = (target + sum) / 2` ï¼Œé—®é¢˜å°±è½¬åŒ–ä¸ºåœ¨ `nums` ä¸­é€‰æ‹©ä¸€äº›æ•°å­—ï¼Œä½¿å…¶ç´¯åŠ å’Œä¸º `(target + sum) / 2` çš„ä¸åŒé€‰æ³•æœ‰å‡ ç§
>   - åŠ¨æ€è§„åˆ’çš„è½¬ç§»æ–¹ç¨‹è§ `subSetByDPBySpaceCompression()`
> - ***ç©ºé—´å‹ç¼©çš„åŠ¨æ€è§„åˆ’***
>   - ç”±äºäºŒç»´åŠ¨æ€è§„åˆ’æ˜¯ä¸¥æ ¼ä½ç½®ä¾èµ–çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ»šåŠ¨æ•°ç»„æ¥è¿›è¡Œç©ºé—´å‹ç¼©ï¼Œå…·ä½“å®ç°çœ‹ `subSetByDPBySpaceCompression()` 

```java
class Solution {
    
    public int findTargetSumWays(int[] nums, int target) {
        // return findTargetSumWaysByViolenceRecursion(nums, target);
        // return findTargetSumWaysByMemorySearch(nums, target);
        return findTargetSumWaysByDP(nums, target);
    }
    
    // æš´åŠ›é€’å½’
    public int findTargetSumWaysByViolenceRecursion(int[] nums, int target) {
        return violenceRecursion(nums, 0, target);
    }
    
    public int violenceRecursion(int[] nums, int index, int rest) {
        if (index == nums.length) {
            // å‡å®šèƒ½å‡‘å‡ºrestï¼Œå¦‚æœæœ€åå‡å»ç»“æœä¸ä¸º0ï¼Œåˆ™è®¤ä¸ºå½“å‰è·¯å¾„æ²¡æ³•æ„æˆrest
            return rest == 0 ? 1 : 0;
        } else {
            // å‰è€…ä¸ºå–+å·
            // åè€…ä¸ºå–-å·
            return violenceRecursion(nums, index + 1, rest - nums[index]) + violenceRecursion(nums, index + 1, rest + nums[index]);
        }
    }
    
    // è®°å¿†åŒ–æœç´¢
    public int findTargetSumWaysByMemorySearch(int[] nums, int target) {
        return recursionByMemorySearch(nums, 0, target, new HashMap<Integer, HashMap<Integer, Integer>>());
    }
    
    // é‡‡ç”¨HashMapå¥—HashMapçš„ç»“æ„æ¥å­˜å‚¨ï¼Œä¸€ä¸ªindexå¯¹åº”å¦å¤–çš„ä¸€å¼ è¡¨ï¼Œè¯¥è¡¨ä¸»é”®ä¸ºrest
    public int recursionByMemorySearch(int[] nums, int index, int rest, HashMap<Integer, HashMap<Integer, Integer>> map) {
        if (map.containsKey(index) && map.get(index).containsKey(rest)) {
            // æœ‰é”®
            return map.get(index).get(rest);
        } else {
            int ans;
            if (index == nums.length) {
                // å‡å®šèƒ½å‡‘å‡ºrestï¼Œå¦‚æœæœ€åå‡å»ç»“æœä¸ä¸º0ï¼Œåˆ™è®¤ä¸ºå½“å‰è·¯å¾„æ²¡æ³•æ„æˆrest
                
                ans = rest == 0 ? 1 : 0;
            } else {
                // å‰è€…ä¸ºå–+å·
                // åè€…ä¸ºå–-å·
                ans = recursionByMemorySearch(nums, index + 1, rest - nums[index], map) + recursionByMemorySearch(nums, index + 1, rest + nums[index], map);
            }
            // æ²¡æœ‰è¿™ä¸ªindexé”®ï¼Œå…ˆå»ºå¥½
            if (!map.containsKey(index)) {
                map.put(index, new HashMap<Integer, Integer>());
            }
            map.get(index).put(rest, ans);
            return ans;
        }
    }
    
    // ç»è¿‡å¤§é‡ä¼˜åŒ–çš„åŠ¨æ€è§„åˆ’
    public int findTargetSumWaysByDP(int[] nums, int target) {
        int sum = 0;
        for (int num : nums) {
            sum += num;
        }
        // return sum < target || ((target & 1) ^ (sum & 1)) != 0 ? 0 : subSetByDP(nums, (target + sum) >> 1);
        return sum < target || ((target & 1) ^ (sum & 1)) != 0 ? 0 : subSetByDPBySpaceCompression(nums, (target + sum) >> 1);
    }
    
    // äºŒç»´çš„åŠ¨æ€è§„åˆ’
    // æœ€ç»ˆå¾—å‡ºåœ¨numsä¸­ä»»æ„é€‰æ‹©æ•°å­—ï¼Œé€‰å‡ºçš„æ•°å­—çš„ç´¯åŠ å’Œç­‰äºsumçš„ä¸åŒé€‰æ³•æœ‰å‡ ç§
    public int subSetByDP(int[] nums, int sum) {
        if (sum < 0) {
            return 0;
        } else {
            // dp[i][j]æŒ‡åœ¨numsçš„å‰iä¸ªæ•°å­—ä¸­è‡ªç”±é€‰æ‹©æ•°å­—ï¼Œé€‰æ‹©çš„æ•°å­—çš„ç´¯åŠ å’Œä¸ºjçš„é€‰æ³•æœ‰å‡ ä¸ª
            int[][] dp = new int[nums.length + 1][sum + 1];
            // ä¸é€‰ï¼Œç©ºé›†
            dp[0][0] = 1;
            // ç¬¬ä¸€è¡Œé™¤äº†ä¸é€‰å¯ä»¥ç»„æˆsumä¸º0çš„æƒ…å†µï¼Œå…¶ä»–éƒ½ä¸è¡Œï¼Œå› ä¸º0è¡Œè¡¨ç¤ºå‰0ä¸ªå³ä¸é€‰æ•°å­—
            for (int i = 1; i <= nums.length; ++i) {
                for (int j = 0; j <= sum; ++j) {
                    // ä¸é€‰å½“å‰æ•°å­—ï¼Œåˆ™ç»“æœä¸ºå‰i - 1ä¸ªæ•°ä¸­è‡ªç”±é€‰æ‹©ï¼Œé€‰å‡ºç´¯åŠ å’Œä¸ºjçš„é€‰æ³•æœ‰å‡ ç§
                    dp[i][j] = dp[i - 1][j];
                    if (j - nums[i - 1] >= 0) {
                        // å¦‚æœå½“å‰éœ€è¦çš„sumå¤§äºnumsçš„ç¬¬iä¸ªæ•°å­—ï¼Œé‚£ä¹ˆæˆ‘å¯ä»¥é€‰å®ƒï¼Œé€‰äº†å®ƒå°±è¦åœ¨å‰i - 1ä¸ªæ•°å­—ä¸­é€‰æ‹©å’Œä¸ºj - nums[i - 1]çš„é€‰æ³•
                        dp[i][j] += dp[i - 1][j - nums[i - 1]];
                    }
                }
            }
            return dp[nums.length][sum];
        }
    }
    
    // ç©ºé—´å‹ç¼©
    public int subSetByDPBySpaceCompression(int[] nums, int sum) {
        if (sum < 0) {
            return 0;
        } else {
            // äºŒç»´è¡¨çš„ç¬¬ä¸€åˆ—å·²ç»å»ºç«‹å¥½
            int[] dp = new int[sum + 1];
            dp[0] = 1;
            // éå†index
            for (int num : nums) {
                // é¦–å…ˆåŸäºŒç»´è¡¨ä¸­æ¯ä¸ªä½ç½®çš„å€¼è‚¯å®šä¾èµ–å…¶ä¸Šé¢ä¸€ä¸ªä½ç½®çš„å€¼
                // å…¶æ¬¡æˆ‘ä»¬ä»åé¢å¼€å§‹å¡«ï¼Œå› ä¸ºsumè¶Šå¤§ï¼Œèƒ½é€‰æ‹©è‡ªå·±çš„é€‰æ³•å°±å­˜åœ¨ï¼Œç›´åˆ°æŸä¸ªä½ç½®æ—¶ä¸èƒ½å†é€‰è‡ªå·±ï¼Œç»“æŸå¾ªç¯
                for (int i = sum; i - num >= 0; --i) {
                    // å› ä¸ºæ˜¯ä»å³å¾€å·¦å¡«ï¼Œåˆ™å·¦è¾¹çš„æ˜¯ä¸Šä¸€è¡Œçš„æ•°æ®
                    dp[i] += dp[i - num];
                }
            }
            return dp[sum];
        }
    }
    
}
```

---

> ğŸš©***last change: 2022/9/26***

---
